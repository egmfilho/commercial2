.open-order(layout='column' layout-fill)
	md-toolbar.open-order-container-nav
		.md-toolbar-tools(layout='row')
			.logo-container(flex='15')
				.logo

			span(flex)

			div(flex='60' layout='column')
				.clown(layout='row' layout-fill)
					md-input-container.md-select(flex)
						label Empresa
						md-select(name='type' ng-model='openOrder.companyId' ng-change='openOrder.getOrders()')
							md-option(ng-value='c.company_id' ng-repeat='c in openOrder.companies') 
								| {{c.company_erp.company_code}} - {{c.company_erp.company_name}}

					div(flex='initial' layout='row' style='min-width: 120px')
						md-input-container.datepicker()
							label Início
							md-datepicker(ng-model='openOrderCalendar.start.value' md-hide-icons='calendar' md-is-open='openOrderCalendar.start.isCalendarOpen' ng-change='openOrderCalendar.start.update()' md-max-date='openOrderCalendar.start.maxDate')
						
						//- div(flex='20')
							md-button.md-icon-button.md-primary(style='margin-top: 12px' ng-click='openOrderCalendar.start.isCalendarOpen = true')
								md-icon(md-font-icon='fa fa-calendar')

				.clown(layout='row' layout-fill)
					md-input-container(flex='20')
						label Código
						input(name='seller-code'
								ng-value='openOrder.seller.person_code' 
								blur-to='openOrder.seller.person_code'
								keys-shortcuts
								enter='openOrder.getSellerByCode($event.target.value)')

					.autocomplete(flex layout="row")
						button(ng-show='openOrder.seller.person_id' ng-click='openOrder.seller=null')
							i.fa.fa-times-circle

						md-autocomplete(flex
										ng-model-options='{ debounce: 250 }'
										md-delay='250'
										md-input-name='autocompleteSeller'
										md-no-cache='false'
										md-autoselect='true'
										md-selected-item='openOrder.seller'
										md-search-text='sellerQuery'
										md-items='item in openOrder.getSellerByName(sellerQuery)'
										md-item-text='item.person_name'
										md-min-length='3'
										md-floating-label='Vendedor')
							md-item-template
								div(md-highlight-text='sellerQuery' style='line-height: 2') {{item.person_name}}
								div(style='font-size: 11px;line-height: 1')
									| Código: 
									| {{item.person_code}}

					div(flex='initial' layout='row')
						md-input-container.datepicker(flex)
							label Fim
							md-datepicker(ng-model='openOrderCalendar.end.value' md-hide-icons='calendar' md-is-open='openOrderCalendar.end.isCalendarOpen' md-min-date='openOrderCalendar.end.minDate' md-max-date='openOrderCalendar.end.maxDate' ng-change='openOrderCalendar.end.update()')
						
						//- div(flex='20')
							md-button.md-icon-button.md-primary(style='margin-top: 12px' ng-click='openOrderCalendar.end.isCalendarOpen = true')
								md-icon(md-font-icon='fa fa-calendar')

			span(flex)

			.end-menu(flex='15' layout='column' layout-fill)
				span(flex)

				div(layout='row' layout-align='center center')
					md-button.md-raised.filter(ng-click='openOrder.getOrders()' md-colors='{ background: "commercialBlue" }')
						i.material-icons(style='font-size: 16px; vertical-align: text-top') refresh&nbsp;
						| Atualizar

				span(flex)

				div(layout='row' layout-align='center center')
					md-button.md-raised(ng-click='newOrder(openOrder.companyId)' md-colors='{ background: "commercialGreen" }')
						i.material-icons(style='font-size: 16px; vertical-align: text-top') note_add&nbsp;
						| Novo

				span(flex)

		.order-table-header-container
			table.table.order-table
				thead
					tr
						th.sortable &nbsp;
						
						th.sortable(ng-click="openOrder.sortBy('order_code')")
							| CÓDIGO
							i.fa(ng-show="openOrder.grid.propertyName === 'order_code'" ng-class="!openOrder.grid.reverse ? 'fa-sort-amount-asc' : 'fa-sort-amount-desc'")
						
						th.sortable(ng-click="openOrder.sortBy('order_code_erp')")
							| ERP
							i.fa(ng-show="openOrder.grid.propertyName === 'order_code_erp'" ng-class="!openOrder.grid.reverse ? 'fa-sort-amount-asc' : 'fa-sort-amount-desc'")
						
						th.sortable(ng-click="openOrder.sortBy('order_customer_name')")
							| CLIENTE
							i.fa(ng-show="openOrder.grid.propertyName === 'order_customer_name'" ng-class="!openOrder.grid.reverse ? 'fa-sort-amount-asc' : 'fa-sort-amount-desc'")
						
						th.sortable(ng-click="openOrder.sortBy('order_seller_name')")
							| VENDEDOR
							i.fa(ng-show="openOrder.grid.propertyName === 'order_seller_name'" ng-class="!openOrder.grid.reverse ? 'fa-sort-amount-asc' : 'fa-sort-amount-desc'")
						
						th.sortable(ng-click="openOrder.sortBy('order_value_total_plus_st')")
							| TOTAL
							i.fa(ng-show="openOrder.grid.propertyName === 'order_value_total_plus_st'" ng-class="!openOrder.grid.reverse ? 'fa-sort-amount-asc' : 'fa-sort-amount-desc'")
						
						th.sortable(ng-click="openOrder.sortBy('order_date_formatted')")
							| DATA
							i.fa(ng-show="openOrder.grid.propertyName === 'order_date_formatted'" ng-class="!openOrder.grid.reverse ? 'fa-sort-amount-asc' : 'fa-sort-amount-desc'")
						
						th &nbsp;
						th &nbsp;
						th &nbsp;
						th &nbsp;

	div(flex)
		md-virtual-repeat-container#virtual-repeat-container
			.repeated-item(layout='row' layout-align='start center' md-virtual-repeat='o in (filteredList = (openOrder.orders | orderBy:openOrder.grid.propertyName:openOrder.grid.reverse | filter: { queryable: openOrder.filters.query, order_status_id: openOrder.filters.status, order_export_type: openOrder.filters.exportType }))' ng-dblclick='open(o)')
				span &nbsp;
					i.material-icons(ng-style='{ "color": o.cloudColor}' ng-class='{ "cloud-open": o.isOpen, "cloud-exported": o.isExported, "cloud-billed": o.isBilled }') &nbsp;
				span {{o.order_code}}
				span {{o.order_code_erp}}
				span {{o.order_customer_name}}
				span {{o.order_seller_name}}
				span {{o.order_value_total_plus_st_formatted}}
				span {{o.order_date_formatted}}
				span 
					button(ng-click='open(o)' md-no-ink)
						i.fa.fa-pencil
				span
					button(ng-click='openOrder.print(o.order_code)' md-no-ink)
						i.fa.fa-print
				span
					button(ng-click='openOrder.mail(o.order_code)' md-no-ink)
						i.fa.fa-envelope
				span
					button(ng-click='delete(o)' md-no-ink)
						i.fa.fa-remove

	.search-container(layout='row' ng-class='{ "opened": isSearchOpened }')
		span(flex)
		.search
			input(type='text' placeholder='Pesquisar' ng-model='tempFilter' keys-shortcuts escape='setSearchOpen(false)' enter='openOrder.filters.query = tempFilter')
			a(ng-click='setSearchOpen(false)')
				i.fa.fa-remove

	md-toolbar.info(layout='column')
		.md-toolbar-tools(flex layout='row' layout-fill)
			.filters(flex='30' layout='row' layout-align='start')
				.status-filter(ng-click='openOrder.filters.setStatus("open", openOrder.orderStatusValues["open"], 1)')
					md-icon(
						md-font-set='material-icons' 
						ng-style='{ "color": openOrder.orderExportTypeColors["open"] }') cloud_queue
					md-tooltip(md-direction='top') 
						| Salvo
		
				span(flex)

				.status-filter(ng-click='openOrder.filters.setStatus("order", openOrder.orderStatusValues["exported"], 3)')
					md-icon(
						md-font-set='material-icons' 
						ng-style='{ "color": openOrder.orderExportTypeColors["order"] }') cloud
					md-tooltip(md-direction='top') 
						| Pedido exportado

				span(flex)

				.status-filter(ng-click='openOrder.filters.setStatus("order", openOrder.orderStatusValues["billed"], 5)')
					md-icon(
						md-font-set='material-icons' 
						ng-style='{ "color": openOrder.orderExportTypeColors["order"] }') cloud_done
					md-tooltip(md-direction='top')
						| Pedido faturado

				span(flex)

				.status-filter(ng-click='openOrder.filters.setStatus("dav", openOrder.orderStatusValues["exported"], 7)')
					md-icon(
						md-font-set='material-icons' 
						ng-style='{ "color": openOrder.orderExportTypeColors["dav"] }') cloud
					md-tooltip(md-direction='top') 
						| Dav exportado

				span(flex)

				.status-filter(ng-click='openOrder.filters.setStatus("dav", openOrder.orderStatusValues["billed"], 9)')
					md-icon(
						md-font-set='material-icons' 
						ng-style='{ "color": openOrder.orderExportTypeColors["dav"] }') cloud_done
					md-tooltip(md-direction='top') 
						| Dav faturado

			div(flex layout='row' layout-align='center center')
				span.md-subhead Orçamentos: {{ filteredList ? filteredList.length : 0 }} &nbsp; Valor total: {{ openOrder.getSum(filteredList) | currency:'R$ '}}

			div(flex='30' layout='row' layout-align='end center')
				md-button.md-icon-button.search-button(ng-click='setSearchOpen(true)')
					md-tooltip(md-direction='left') 
						| Pesquisar ({{ 'M-F' | keyboardShortcut }})
					md-icon.text-primary(md-font-set='material-icons') search